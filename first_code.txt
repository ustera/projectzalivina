
Процедура КнопкаВыполнитьНажатие(Кнопка)
	Попытка    
		Excel = Новый COMОбъект("Excel.Application");
		Excel.WorkBooks.Open(Объект.ПутьКФайлу);    
		ExcelЛист = Excel.Sheets(1); 
	Исключение    
		Excel.WorkBooks.Close();    
		Excel = 0;    
		Сообщить("Ошибка обработки файла"); 
	Возврат; 
	КонецПопытки;   
	x = 1;    
	Пока НЕ СокрЛП(ExcelЛист.Cells(х,1).Text) = "" Цикл
		
		Строка = Новый Структура;
		Строка.Вставить("ПерваяКолонка", СокрЛП(ExcelЛист.Cells(х,1).Text));    
		Строка.Вставить("ВтораяКолонка", СокрЛП(ExcelЛист.Cells(х,2).Text));          
		х= х + 1; 
	КонецЦикла;
	
	Док=документы.УстановкаЦенНоменклатуры.СоздатьДокумент():
	Док.дата=выбдата;
	стр=док.ТипыЦен.Добавить();
	стр.ТипЦен=выбтипцен;
	док.записать();
	Для i=1 по колстрок цикл
		Под=найти(п_артикул,&quot;_&quot;);
		Если сред(п_артикул,под,2)=&quot;^^&quot; тогда
			ном=справочники.Номенклатура.Выбрать();
			Пока ном.Следующий()=Истина цикл
				если лев(ном.Артикул,под)=лев(п_артикул) тогда

					стр=док.Товары.Добавить();
					стр.Валюта=ВыбВалюта;

				конецесли
			конеццикла;     	
		Иначе

			п_ном=справочники.Номенклатура.НайтиПоРеквизиту(&quot;Артикул&quot;,п_артикул);

				Если п_ном.Пустая() тогда
					п_ном=справочники.Номенклатура.СоздатьЭлемент();
					п_ном.Артикул

					п_ном.БазоваяЕдиницаИзмерения=справочники.КлассификаторЕдиницИзмерения.НайтиПоКоду(&quot;796&quot;);

					п_ном.Записать();
					Спред=справочники.ЕдиницыИзмерения.СоздатьЭлемент();

					спред.Владелец=ном.Ссылка;

					спред.ЕдиницаПоКлассификатору=справочники.КлассификаторЕдиницИзмерения.НайтиПоКоду(&quot;796&quot;);

					спред.Коэффициент=1;
					спред.Наименование=&quot;штуки&quot;;
					спред.Записать();
					п_ном.ЕдиницаХраненияОстатков=спред.Ссылка;
					п_ном.ЕдиницаДляОтчетов=спред.Ссылка;
					п_ном.Записать();
				конецесли;
			стр=док.Товары.Добавить();
			стр.Валюта=ВыбВалюта;
			стр.Номенклатура=п_ном.Ссылка;
		конецесли;
КонецПроцедуры
